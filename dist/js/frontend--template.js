function checkSupportWebp(){var e=document.createElement("canvas");e.getContext&&e.getContext("2d")?(document.body.classList.add("support-webp"),document.body.classList.remove("no-support-webp")):(document.body.classList.add("no-support-webp"),document.body.classList.remove("support-webp"))}function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return!!t&&decodeURIComponent(t[1])}function initSelect(e,t={autocomplete:!1}){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return;let a=[...e.querySelectorAll("option")],o=a.map((e=>({label:e.innerHTML,value:e.value}))),r=e.id;e.setAttribute("data-select-id",r);const l=e.parentElement.querySelector("#"+r+"-cover")||document.createElement("div");l.classList.add("form-select"),l.id=r+"-cover",l.innerHTML="",Promise.resolve().then((()=>e.insertAdjacentElement("beforebegin",l))).then((()=>e.setAttribute("hidden",!0))).then((()=>{new SelectPure("#"+l.id,{options:o,initValue:a.find((e=>e.selected)).value,multiple:e.multiple,classNames:{select:"select-pure__select form-input"},autocomplete:t.autocomplete,placeholder:e.getAttribute("placeholder"),icon:"form-select-remove",inlineIcon:!1,onChange:t=>{a.map((e=>e.selected=t.includes(e.value)));var o=new Event("change",{bubbles:!0,cancelable:!0}),r=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(o),e.dispatchEvent(r)}})}))}function slidersInit(){if(document.querySelector(".user-tab-links")){var e=new Swiper(".user-tab-links",{watchSlidesProgress:!0,watchSlidesVisibility:!0,loop:!1,spaceBetween:8,slidesPerView:"auto",slidesPerGroup:1,slideClass:"swiper-slide",touchRatio:1,navigation:{nextEl:".user-tab-arrow-next",prevEl:".user-tab-arrow-prev"},breakpoints:{540:{centeredSlides:!1},992:{touchRatio:0}}});function t(t){if(!t.target.closest(".user-tab-links .swiper-slide"))return;let a=e.clickedIndex-1;e.slideTo(a)}document.addEventListener("click",t)}if(document.querySelector(".team-slider")){function t(t){if(!t.target.closest(".user-tab-links .swiper-slide"))return;let a=e.clickedIndex-1;e.slideTo(a)}e=new Swiper(".team-slider",{watchSlidesProgress:!0,watchSlidesVisibility:!0,loop:!1,spaceBetween:8,slidesPerView:1,slidesPerGroup:1,slideClass:"swiper-slide",touchRatio:1,navigation:{nextEl:".team-slider-next",prevEl:".team-slider-prev"},breakpoints:{540:{slidesPerView:2,spaceBetween:15},992:{slidesPerView:3},1200:{slidesPerView:4}}}),document.addEventListener("click",t)}document.querySelector(".jk-item-gallery-slider")&&new Swiper(".jk-item-gallery-slider",{watchSlidesProgress:!0,watchSlidesVisibility:!0,loop:!1,spaceBetween:10,slidesPerView:1,slidesPerGroup:1,slideClass:"swiper-slide",touchRatio:1,navigation:{prevEl:".jk-item-gallery-arrow-prev",nextEl:".jk-item-gallery-arrow-next"},pagination:{el:".jk-item-gallery-pagination",type:"fraction"},breakpoints:{992:{}}}),document.querySelector(".jk-inner-thumbs")&&new Swiper(".jk-inner-thumbs",{watchSlidesProgress:!0,watchSlidesVisibility:!0,loop:!1,spaceBetween:10,slidesPerView:4,slidesPerGroup:1,touchRatio:0,navigation:{prevEl:".jk-inner-thumbs-prev",nextEl:".jk-inner-thumbs-next"},breakpoints:{621:{slidesPerView:6},681:{slidesPerView:8}}}),document.querySelector(".jk-inner-slider")&&new Swiper(".jk-inner-slider",{watchSlidesProgress:!0,watchSlidesVisibility:!0,loop:!1,spaceBetween:10,slidesPerView:1,slidesPerGroup:1,touchRatio:1,navigation:{prevEl:".jk-inner-slider-prev",nextEl:".jk-inner-slider-next"},pagination:{el:".jk-inner-slider-pagination",type:"custom",renderCustom:function(e,t,a){return t+" из "+a}},thumbs:{swiper:document.querySelector(".jk-inner-thumbs").swiper},breakpoints:{992:{}}})}function isReady(e){const t=[...e.querySelectorAll("input"),...e.querySelectorAll("select"),...e.querySelectorAll("textarea")].filter((e=>"hidden"!=e.type));let a=!0;for(const e in t)if(Object.hasOwnProperty.call(t,e))if("checkbox"==t[e].type||"radio"==t[e].type){if(0==t[e].checked&&t[e].required){a=!1;break}}else if(""==t[e].value&&t[e].required){a=!1;break}return a}function initPhoneMask(){$('input[type="tel"]').mask("+7 (9 9 9) 9 9 9 - 9 9 - 9 9",{placeholder:"_"}),$('input[type="tel"]').on("click",(e=>{const t=e.target.value.indexOf("_");setTimeout((()=>{e.target.selectionStart>t&&e.target.setSelectionRange(t,t)}),100)}))}function initFancybox(){$("[data-fancybox-modal]").fancybox({type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl,afterLoad:(e,t)=>{window.Tab.init(t.$content[0]),window.Toggle.init(t.$content[0]),initPhoneMask(),initFancybox()}})}function validateForm(e){const t=[...e.querySelectorAll("input")].filter((e=>e.required));let a=!0;const o=e=>{const t=e.target.closest(".form-field");if(!t)return;t.classList.remove("form-field--error");const a=t.querySelector(".form-helper");a&&(a.textContent="")};return t.map((e=>{const t=e.closest(".form-field");if(t&&""==e.value.trim()){a=!1,t.classList.add("form-field--error"),e.addEventListener("input",o);const r=t.querySelector(".form-helper")||document.createElement("div");r.classList.add("form-helper"),r.textContent="Заполните поле",t.appendChild(r)}})),a}function user_filter_find(){let e,t,a,o=$(".filter-form:not(.hidden) .-ChooseObj-:checked").data("choose");"house"==o&&(e=$("#select-id-13 option:selected").text(),t=$("#MAIN_FILTER_18_MAX").val(),a=$("#MAIN_FILTER_20_MAX").val()),"flat"==o&&(e=$("#select-id-55 option:selected").text(),t=$("#MAIN_FILTER_63_MAX").val(),a=$("#MAIN_FILTER_57_MAX").val()),$.ajax({url:"/local/ajax/user-filter-find.php",data:{TYPEHOUSE:e,PRICE:t,S_HOUSE:a},success:function(e){e.status?$("#userfilerform_"+o).html('<div class="filter-form__link filter-form__remove "> <button type="button" class="link save-user-filter-form -saved-search-item__remove-" data-action="remove" data-modal-link="delete-saved" data-id="'+e.id+'"> <svg class="icon"> <use xlink:href="/local/img/sprite.svg#delete" /></svg> Удалить поиск </button> </div>'):$("#userfilerform_"+o).html('<div class="filter-form__link "> <a class="link save-user-filter-form -save-user-filter-form-add-" data-action="add"> <svg class="icon"> <use xlink:href="/local/img/sprite.svg#like-search" /></svg> Сохранить фильтр и оповещать о новых объектах </a> </div>')},dataType:"json"})}function calk_user_filters(e,t){var a=$("."+e),o=0;!function e(){let r=$(a.eq(o)).data("id");$("."+t).eq(o++).load("/local/ajax/user-filter-count.php?id="+r,e)}()}function fallbackCopyTextToClipboard(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)}function copyTextToClipboard(e){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){}),(function(e){console.error("Async: Could not copy text: ",e)})):fallbackCopyTextToClipboard(e)}function removeHelper(e,t){const a=e.closest(".form-field");if(!a)return;a.classList.remove("form-field--error");const o=a.querySelector(".-dinamic-form-helper-");o&&(t&&o.textContent!=t||o.parentElement.removeChild(o))}function addHelper(e,t,a){const o=e.closest(".form-field");if(!o)return;const r=o.querySelector(".-dinamic-form-helper-")||document.createElement("div");r.classList.add("form-helper"),r.classList.add("-dinamic-form-helper-"),r.textContent=t,a&&(r.style.color="#EA4D3D"),a||(r.style.color=""),o.appendChild(r)}checkSupportWebp(),window.addEventListener("load",(function(){slidersInit()})),document.addEventListener("click",(function(e){e.target.closest("a[href]")&&function(){const t=e.target.closest("a[href]").getAttribute("href");if(!t)return;if("#"!=t[0]||"#"==t)return;e.preventDefault();const a=document.createElement("div");a.style.position="absolute",a.style.left="0",a.style.top="-91px",document.querySelector(t).style.position="relative",document.querySelector(t).appendChild(a),a.scrollIntoView({behavior:"smooth",block:"start"}),document.querySelector(t).removeChild(a),document.querySelector(t).style.position=""}()})),Waves.init({duration:1e3}),Waves.attach(".btn",["waves-custom"]),Waves.attach(".waves",["waves-custom"]),function(e,t){return{init:()=>{const e=document.querySelectorAll("[data-tooltip]");for(const a in e){if(!Object.hasOwnProperty.call(e,a))continue;const o=document.createElement("div");o.classList.add("tooltip");let r=t.position||t.getPosition&&t.getPosition(e[a])||"top";o.classList.add("tooltip--"+r),o.textContent=t.title||t.getTitle&&t.getTitle(e[a])||"tooltip",e[a].classList.add("tooltip-parent"),e[a].appendChild(o),e[a].removeAttribute("title")}}}}(0,{getTitle:e=>e.getAttribute("title"),getPosition:e=>e.getAttribute("data-tooltip-position")}).init(),function(){const e={clear:{key:"1",name:"default"},dark:{key:"2",name:"dark"}};let t;function a(e){document.body.setAttribute("data-theme",e.name),t=e}document.addEventListener("keyup",(t=>{for(const o in e)if(e.hasOwnProperty(o)&&t.key==e[o].key&&t.altKey)return void a(e[o])})),function(){const t=getCookie("activeThemeJson");a(t?JSON.parse(t):e.clear)}(),window.addEventListener("unload",(function(){const e=JSON.stringify(t);document.cookie="activeThemeJson="+e+"; path=/; expires=Tue, 19 Jan 2038 03:14:07 GMT"}))}(),function(){function e(e,t,a){const o=t.querySelector("input");if(a){const a=t.querySelector("[data-field-files]"),r=o.detail?[...o.detail.files,...e]:[...e];o.detail={files:r};let l=[...e].filter((e=>"image"==e.type.replace(/\/.+/,"")));for(const e in l){if(!Object.hasOwnProperty.call(l,e))continue;const t=document.createElement("div");t.classList.add("form-field-file");const r=document.createElement("button");r.classList.add("form-field-file__close"),r.addEventListener("click",(a=>{a.stopPropagation(),a.preventDefault(),o.detail={files:o.detail.files.filter((t=>t!=l[e]))},t.parentElement.removeChild(t)}));const s=document.createElement("img");s.src=URL.createObjectURL(l[e]),t.appendChild(s),t.appendChild(r),a.appendChild(t),URL.revokeObjectURL(l[e])}}else o.detail={files:[e[0]]},t.querySelector("[data-preview]").src=URL.createObjectURL(e[0]),URL.revokeObjectURL(e[0]),t.classList.add("active"),o.required=!1,o.setAttribute("data-required","true")}document.addEventListener("change",(function(t){const a=t.target.closest("[data-field]");if(!a)return;const o=!!t.target.closest("[data-field].form-field--multiple");return t.target.files,t.target.files.length>0?(e(t.target.files,a,o),void a.classList.add("active")):void 0})),document.addEventListener("dragenter",(e=>{e.preventDefault(),[...document.querySelectorAll(".form-field--dropable")].map((e=>e.classList.add("waiting"))),e.target.closest(".form-field--dropable")&&e.target.closest(".form-field--dropable").classList.add("hovered")})),document.addEventListener("dragleave",(e=>{e.preventDefault(),e.target.closest(".form-field--dropable")&&e.relatedTarget&&!e.relatedTarget.closest(".form-field--dropable")&&e.target.closest(".form-field--dropable").classList.remove("hovered"),e.target.closest("html")&&!e.relatedTarget&&[...document.querySelectorAll(".form-field--dropable")].map((e=>e.classList.remove("waiting")))})),document.addEventListener("dragexit",(e=>{e.preventDefault()})),document.addEventListener("dragover",(e=>{e.preventDefault()})),document.addEventListener("drop",(t=>{t.preventDefault(),[...document.querySelectorAll(".form-field--dropable")].map((e=>{e.classList.remove("hovered"),e.classList.remove("waiting")}));const a=t.target.closest("[data-field]");if(a)return t.target.closest("[data-field].form-field--multiple")&&t.dataTransfer.files.length>0?(e(t.dataTransfer.files,a,!0),void a.classList.add("active")):void(t.dataTransfer.files.length>0&&(e(t.dataTransfer.files,a,!1),a.classList.add("active")))})),document.addEventListener("click",(e=>{if(!e.target.closest("[data-clear-file]"))return;const t=e.target.getAttribute("data-for"),a=document.getElementById(t);if(!a)return;a.value="",a.innerHTML=a.innerHTML;const o=a.closest("[data-field]");o&&(o.querySelector("[data-preview]").src="")}))}(),function(){function e(e){const t=e.closest(".jk-edit-modal").querySelector('[data-edit-nav="'+e.id+'"]');isReady(e)?t.classList.add("active"):t.classList.remove("active")}function t(e){isReady(e)?e.classList.remove("is-empty"):e.classList.add("is-empty")}document.addEventListener("modalopen",(function(t){const a=t.detail.target.querySelectorAll("[data-edit-block]");for(const t in a)Object.hasOwnProperty.call(a,t)&&e(a[t])})),document.addEventListener("input",(function(t){const a=t.target.closest("[data-edit-block]");a&&e(a)})),document.addEventListener("click",(function(a){if(a.target.closest("[data-copy-node]")){const o=a.target.closest("[data-copy-node]").getAttribute("data-copy-node"),r=document.getElementById(o),l=r.cloneNode(!0),s=[];[...r.querySelectorAll("input[id]"),...r.querySelectorAll("select[id]")].map((e=>{let t=e.id,a=t+"-0";if(null!=e.getAttribute("data-select-id")){const t=l.querySelector("#"+e.getAttribute("data-select-id")+"-cover");t.parentElement.removeChild(t),s.push(l.querySelector("#"+e.id))}if(document.getElementById(a))for(let e=1;a=t+"-"+e,document.getElementById(a);e++);l.querySelector("#"+e.id).id=a})),l.setAttribute("data-copy-target",o),function(e){const t=[...e.querySelectorAll("input"),...e.querySelectorAll("textarea")].filter((e=>"hidden"!=e.type));for(const e in t)Object.hasOwnProperty.call(t,e)&&("checkbox"==t[e].type||"radio"==t[e].type?t[e].checked=!1:t[e].value="")}(l),t(l);let n=o+"-0";if(document.getElementById(n))for(let e=1;n=o+"-"+e,document.getElementById(n);e++);l.id=n,l.querySelector('[data-remove-node="'+o+'"]')&&[...l.querySelectorAll("[data-remove-node]")].map((e=>{e.setAttribute("data-remove-node",n)}));let i=document.querySelectorAll('[data-copy-target="'+o+'"]');const c=r.getAttribute("data-max-copy");if(null!=c&&i.length>=c)return void r.classList.add("max-copy");r.classList.remove("max-copy"),0==i.length?r.insertAdjacentElement("afterend",l):i[i.length-1].insertAdjacentElement("afterend",l),$('input[type="tel"]').mask("+7 (9 9 9) 9 9 9 - 9 9 - 9 9"),s.map((e=>initSelect(e,{autocomplete:e.getAttribute("data-autocomplete")})));const d=r.closest("[data-edit-block]");if(d&&e(d),null!=c&&i.length>=c-1)return void r.classList.add("max-copy");r.classList.remove("max-copy")}if(a.target.closest("[data-remove-node]")){const t=a.target.closest("[data-remove-node]").getAttribute("data-remove-node"),o=document.getElementById(t),r=o.closest("[data-edit-block]");o.parentElement.removeChild(o);const l=o.getAttribute("data-copy-target"),s=document.getElementById(l),n=document.querySelectorAll('[data-copy-target="'+l+'"]'),i=s.getAttribute("data-max-copy");null!=i&&n.length>=i?s.classList.add("max-copy"):s.classList.remove("max-copy"),r&&e(r)}})),document.addEventListener("modalopen",(function(e){const a=e.detail.target.querySelectorAll("[data-fields-isempty]");for(const e in a)Object.hasOwnProperty.call(a,e)&&t(a[e]);const o=e.detail.target.querySelectorAll("[data-fields-isempty]");for(const e in o)Object.hasOwnProperty.call(o,e)&&null!=o[e].getAttribute("[data-fields-isempty]")&&t(o[e])})),document.addEventListener("input",(function(e){const a=e.target.closest("[data-fields-isempty]");a&&t(a)}))}(),document.addEventListener("input",(function(e){if(null!=e.target.getAttribute("data-mask")&&(e.target.getAttribute("data-mask").includes("number")&&function(e){let t=+e.target.value;const a=e.target.getAttribute("max"),o=e.target.getAttribute("min");a&&parseInt(t)>parseInt(a)&&(t=a),o&&parseInt(t)<parseInt(o)&&(t=o),isNaN(t)?e.target.value="":e.target.value=t}(e),e.target.getAttribute("data-mask").includes("year")&&function(e){const t=e.target;if(removeHelper(t),t.value.length>=4){const e=t.getAttribute("min");e&&parseInt(t.value)<parseInt(e)&&(t.value=e)}let a=t.value.substring(0,4);a=parseInt(a.replace(/[^0-9]/g,""));const o=t.getAttribute("max");o&&a>parseInt(o)&&(a=o),isNaN(a)?t.value="":t.value=a;const r=()=>{const e=t.getAttribute("min");e&&parseInt(t.value)<parseInt(e)&&""!=t.value&&(t.value=e),t.removeEventListener("blur",r)};t.addEventListener("blur",r)}(e),e.target.getAttribute("data-mask").includes("int")&&function(e){let t=e.target.value.replace(/[^0-9]/g,"");t=parseInt(t),isNaN(t)?e.target.value="":e.target.value=t}(e),e.target.getAttribute("data-mask").includes("lowercase")&&function(e){e.target.value=e.target.value.toLowerCase()}(e),e.target.getAttribute("data-mask").includes("money")&&function(e){let t=e.target.value.replace(/[^0-9.,]/g,"").replace(/[.,]/g,(a=0,e=>a++?"":e));var a;t=t.replace(/[.,]/g,".");const o=t.split(".");let r=parseInt(o[0]);const l=e.target.getAttribute("max"),s=e.target.getAttribute("min");l&&r>parseInt(l)&&(r=l),s&&r<parseInt(s)&&(r=s);const n=new Intl.NumberFormat("ru-RU").format(r);e.target.value=t,isNaN(r)?e.target.value="":e.target.value=n+(null!=o[1]?"."+o[1]:"")}(e)),null!=e.target.getAttribute("data-target")){const t=e.target.getAttribute("data-target"),a=document.getElementById(t);e.target.getAttribute("data-submit").includes("nospace")&&(a.value=e.target.value.replace(/\s/g,"")),e.target.getAttribute("data-submit").includes("number")&&(a.value=parseInt(e.target.value.replace(/[^0-9]/g,""))),console.log(a.value)}const t=e.target.value,a=e.target.selectionStart;"2"!=t[a-1]||"м"!=t[a-2]||" "!=t[a-3]&&t[a-3]||(e.target.value=t.substr(0,a-1)+"²"+t.substr(a),e.target.selectionStart=a,e.target.selectionEnd=a)})),jQuery(document).ready((function(){jQuery.fancybox.defaults.backFocus=!1,jQuery.fancybox.defaults.hash=!1,jQuery.fancybox.defaults.buttons=["close"],jQuery.fancybox.defaults.idleTime=!1,jQuery.fancybox.defaults.mobile.idleTime=!1,jQuery.fancybox.defaults.mobile.clickOutside=!1,jQuery.fancybox.defaults.mobile.clickSlide=!1,jQuery.fancybox.defaults.mobile.clickContent=!1,jQuery.fancybox.modalInit=initFancybox,jQuery.fancybox.defaults.ajaxTpl='<section class="modal fancybox-container fancybox-modal fancybox-inner" role="dialog" tabindex="-1"><div class="fancybox-infobar"><span data-fancybox-index></span>&nbsp;/&nbsp;<span data-fancybox-count></span></div><div class="fancybox-toolbar">{{buttons}}</div><div class="fancybox-navigation">{{arrows}}</div><div class=" modal-container"><div class="fancybox-stage"></div></div><div class="fancybox-caption"><div class=""fancybox-caption__body"></div></div></section>',initPhoneMask(),jQuery.fancybox.openModal=(e,...t)=>{$.fancybox.open({src:e,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl,...t})},jQuery.fancybox.modalInit()})),document.addEventListener("click",(e=>{e.target.closest(".fancybox-slide")&&!e.target.closest(".fancybox-content")&&jQuery.fancybox.close()})),document.addEventListener("modalopen",(e=>{e.target.closest(".js-modal-alert")&&e.detail.closePromise.then((e=>console.log(!!e)))})),document.addEventListener("click",(e=>{if(!e.target.closest("[data-checkall]"))return;const t=e.target.getAttribute("data-checkall");let a=[...document.getElementById(t).querySelectorAll("input")];a=a.filter((e=>"checkbox"==e.type)).map((e=>e.checked=!0))})),document.addEventListener("click",(async e=>{if(e.target.closest(".-save-user-filter-form-add-")){const t=e.target.closest(".smartfilter"),a=parseInt(t.getAttribute("data-iblockid"));let o,r,l;2==a&&(o=$("#select-id-13 option:selected").text(),r=$("#MAIN_FILTER_20_MAX").val(),l=$("#MAIN_FILTER_18_MAX").val()),6==a&&(o=$("#select-id-55 option:selected").text(),r=$("#MAIN_FILTER_57_MAX").val(),l=$("#MAIN_FILTER_63_MAX").val()),console.log(a,o,r,l),"Все"!=o&&""!=r&&""!=l?(console.log("save"),$.fancybox.open({src:encodeURI("/local/ajax/modal_save_user_filter_form.php?iblockid="+a+"&type="+o+"&pricemax="+l+"&shousemax="+r),type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})):(console.log("error"),$.fancybox.open({src:encodeURI("/local/ajax/modal/error_universal.php?text=Недостаточно данных"),type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl}))}})),$("body").on("click",".notfindforme",(function(e){const t=e.target.closest(".list_hidden_input_form");var a=$(t).find(":input").serialize();validateForm(t)&&$.fancybox.open({src:"/local/ajax/AMOsend.php?ajax=Y&showmodal=filter-success-modal&"+a,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})})),$("body").on("click",".notfindform_false",(function(){var e=$(".list_hidden_input_form :input").serialize();$.fancybox.open({src:"/local/ajax/modal_notfindform_false.php?"+e,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})})),$("body").on("click",".save-callback-modal",(function(){var e=$(".form-callback-modal :input").serialize();$.fancybox.open({src:"/local/ajax/AMOsend.php?ajax=Y&showmodal=callback-success-modal&"+e,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})})),$("body").on("click",".save-callback-expertise-modal",(function(){var e=$(".callback-expertise-modal :input").serialize();validateForm(document.querySelector(".callback-expertise-modal"))&&$.fancybox.open({src:"/local/ajax/AMOsend.php?ajax=Y&showmodal=callback-expertise-success-modal&"+e,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})})),$("body").on("click",".order_expertise",(function(e){$.fancybox.open({src:"/local/ajax/order_expertise.php?showmodal=Y&ajax=Y",type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})})),document.addEventListener("submit",(async e=>{if(e.target.closest("#modal-filter-user-email-form")){e.preventDefault();const t={method:"POST",body:new FormData(document.getElementById("modal-filter-user-email-form"))};let a=await fetch("/local/ajax/modal_save_user_filter_form.php",t),o=await a.text();o&&($.fancybox.close(),$.fancybox.open(o,{touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl}))}})),window.addEventListener("load",(()=>{document.addEventListener("change",(async e=>{e.target.closest(".smartfilter")&&(e.target.closest("#select-id-13")&&user_filter_find(),e.target.closest("#MAIN_FILTER_18_MAX_pseudo")&&user_filter_find(),e.target.closest("#MAIN_FILTER_20_MAX_pseudo")&&user_filter_find(),e.target.closest("#select-id-55")&&user_filter_find(),e.target.closest("#MAIN_FILTER_63_MAX_pseudo")&&user_filter_find(),e.target.closest("#MAIN_FILTER_57_MAX_pseudo")&&user_filter_find())})),document.addEventListener("keyup",(async e=>{e.target.closest(".smartfilter")&&(e.target.closest("#MAIN_FILTER_18_MAX_pseudo")&&user_filter_find(),e.target.closest("#MAIN_FILTER_20_MAX_pseudo")&&user_filter_find(),e.target.closest("#MAIN_FILTER_63_MAX_pseudo")&&user_filter_find(),e.target.closest("#MAIN_FILTER_57_MAX_pseudo")&&user_filter_find())}))})),window.addEventListener("load",(()=>{document.addEventListener("change",(async e=>{if(e.target.closest(".UF_USE_EMAIL")){let t="update",a="UF_USE_EMAIL",o=$(e.target).prop("checked"),r=$(e.target).data("id");$(e.target).attr("disabled",!0),0==o&&(o=0),$.ajax({url:"/local/ajax/user-filter-action.php",data:{id:r,action:t,field:a,field_value:o},success:function(){$(e.target).attr("disabled",!1)}})}}))})),document.addEventListener("click",(async e=>{if(e.target.closest(".-saved-search-item__remove-")){let t=e.target.closest(".-saved-search-item__remove-").getAttribute("data-id"),a=e.target.closest(".-saved-search-item__remove-").getAttribute("data-postaction");$.fancybox.open({src:"/local/ajax/modal-confirm-remove-user-filter.php?id="+t+"&postaction="+a,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})}})),document.addEventListener("click",(async e=>{if(e.target.closest(".confirmed-remove-user-filter")){let t=$(e.target).data("id"),a=$(e.target).data("postaction");$.ajax({url:"/local/ajax/user-filter-action.php",data:{id:t,action:"remove"},success:function(){"reload"==a&&(location.href="/objects/?del_filter=Y"),"remove"==a&&$("#card_"+t).remove(),$.fancybox.close()}})}})),document.addEventListener("submit",(async e=>{if(e.target.closest("#modal-update-user")){e.preventDefault();const t={method:"POST",body:new FormData(document.getElementById("modal-update-user"))};let a=await fetch("/local/ajax/update_user.php",t),o=await a.json();o.status?($.fancybox.close(),location.reload()):$("#field-password").addClass("form-field--error").append('<div class="form-helper">'+o.text+"</div>")}})),document.addEventListener("submit",(e=>{if(e.target.closest("#modal-request-add")){e.preventDefault();const t=$(e.target).serialize();$.fancybox.close(),$.fancybox.open({src:"/local/ajax/AMOsend.php?ajax=Y&showmodal=modal-request-add&"+t,type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl})}if(e.target.closest("#modal-expertise-nonauth")){e.preventDefault(),$.fancybox.close();const t=$(e.target).serialize();$.ajax({url:"/local/ajax/php/modal-expertise-nonauth-save.php?"+t})}})),$((function(){$("body").on("click",".show_phone",(function(){let e=$(this),t=$(this).data("type");null==t&&(t="get"),"show"==t&&$.ajax({url:"/local/ajax/getphonebyid.php",data:{id:$(this).data("item")},success:function(t){e.removeClass("btn--primary").addClass("btn--primary--light waves-effect waves-custom").text(t)},dataType:"html"}),"get"==t&&($.fancybox.open({src:"/local/ajax/getphonebyid.php?id="+$(this).data("item"),type:"ajax",touch:!1,baseTpl:jQuery.fancybox.defaults.ajaxTpl}),e.removeClass("btn--primary").addClass("btn--primary--light waves-effect waves-custom").text("Запрошено"))}))})),document.addEventListener("click",(e=>{if(!e.target.closest("[data-copy-to-clipboard]"))return;const t=e.target.closest("[data-copy-to-clipboard]").getAttribute("data-copy-to-clipboard"),a=e.target.closest("[data-copy-to-clipboard]");copyTextToClipboard(t),a.classList.contains("copied")||(a.classList.remove("copied"),setTimeout((()=>{a.classList.add("copied")}),100),setTimeout((()=>{a.classList.remove("copied")}),2e3))})),(()=>{const e=t=>{removeHelper(t.target),t.target.removeEventListener("blur",e)},t=t=>{if(!t.target.closest("input"))return;const a=t.target;if(null!=a.getAttribute("data-helper-is-cir")){const t="абвгдеёжзийклмнопрстуфхцчшщъыьэюя",o=t.toUpperCase(),r=t+o,l=[...a.value];let s=!1;l.map((e=>{r.includes(e)&&(s=!0)})),s?(a.removeEventListener("blur",e),addHelper(a,"Содержит кириллицу",!0)):removeHelper(a,"Содержит кириллицу")}};document.addEventListener("keydown",(a=>{if(!a.target.closest("input"))return;const o=a.target;null!=o.getAttribute("data-helper-is-caps")&&a.getModifierState("CapsLock")?(o.addEventListener("blur",e),addHelper(o,"Включен Caps-lock"),t(a)):(o.removeEventListener("blur",e),removeHelper(o,"Включен Caps-lock"))})),document.addEventListener("input",t),window.form={},window.form.validate=e=>{const t=[...e.querySelectorAll("input")];let a=!0;const o=e=>{removeHelper(e.target),e.target.removeEventListener("focus",o)};return t.map((e=>{const t=e.closest(".form-field");t&&null!=e.getAttribute("data-required")&&""==e.value.trim()&&(a=!1,t.classList.add("form-field--error"),e.addEventListener("focus",o),addHelper(e,"Заполните поле"))})),a}})(),document.addEventListener("input",(e=>{if(!e.target.closest("[data-one-required]"))return;const t=e.target.closest("[data-one-required]").getAttribute("data-one-required"),a=document.querySelectorAll(`[data-one-required="${t}"]`);let o=!1;a.forEach((e=>{""!==e.value.trim()&&(o=!0)})),a.forEach((e=>{o&&e.removeAttribute("required"),o||e.setAttribute("required","")}))})),document.addEventListener("tabchange",(e=>{e.detail.target.querySelector(".lk-user-table-btns")&&[...e.detail.target.querySelectorAll(".lk-user-table-btn")].map((e=>{e.classList.contains("tab-active")?(e.classList.add("btn--primary--pale"),e.classList.remove("btn--contur")):(e.classList.remove("btn--primary--pale"),e.classList.add("btn--contur"))}))})),document.addEventListener("click",(e=>{if(e.target.closest(".-statistic-call-")){const t=e.target.closest(".jk-item").getAttribute("data-id");fetch("/local/ajax/php/statistic-call.php?id="+t).then((e=>e.text())).then((e=>console.log(e)))}})),navigator.share&&screen.width<992&&document.addEventListener("click",(e=>{e.target.closest("[data-share-mobile]")&&navigator.share({url:e.target.closest("[data-share-mobile]").getAttribute("data-share-mobile")})})),document.addEventListener("click",(e=>{e.target.closest(".jk-inner-share__copy")&&(e.target.closest(".jk-item").querySelector("#jk-link").select(),document.execCommand("copy"),e.target.closest(".jk-inner-share__copy").textContent="Скопировано")})),window.addEventListener("change",(e=>{if(!e.target.closest(".filter-radio-group"))return;const t=e.target.closest(".filter-radio-group"),a=t.querySelector(".filter-radio-group__grouper"),o=Array.from(t.querySelectorAll(".filter-radio-group__item"));e.target.classList.contains("filter-radio-group__item")&&e.target.checked&&(a.checked=!0),e.target.classList.contains("filter-radio-group__grouper")&&(e.target.checked?o.some((e=>e.checked))||(o[0].checked=!0):o.forEach((e=>e.checked=!1)))}));